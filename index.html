<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>시간표</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
<link rel="stylesheet" href="/TimelineEx/style.css">
</head>
<body>
	
	<div class="Container" id="conatainer" style="float:left; width:100%; height:100%" align="center">
		<div class="table-form-wrapper">
		<table style="color: #121212;" width="800" height="300" class="table caption-top" id="timeline-table">
		<caption>▶   4학년 1학기 시간표  ◀</caption>
		  <tr>
			<th style="background-color:#FFDBF8;"></th>
			<th style="background-color:#FFDBF8;">월</th>
			<th style="background-color:#FFDBF8;">화</th>
			<th style="background-color:#FFDBF8;">수</th>
			<th style="background-color:#FFDBF8;">목</th>
			<th style="background-color:#FFDBF8;">금</th>
		  </tr>
		  <tr>
			<th>9시<br>1교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>10시<br>2교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>11시<br>3교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>12시<br>4교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>13시<br>5교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>14시<br>6교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>15시<br>7교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>16시<br>8교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>17시<br>9교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		</table>

		<form class="form-inline" id="timeline-form" style="margin-top: 200px; margin-right:50px;">
		  <div class="form-group mx-sm-5 mb-2">
			<label for="day" class="sr-only">요일</label>
			<select id="day" name="day" class="form-control">
			  <option value="Mon">월요일</option>
			  <option value="Tue">화요일</option>
			  <option value="Wed">수요일</option>
			  <option value="Thur">목요일</option>
			  <option value="Fri">금요일</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="start-time" class="sr-only">시작 시간</label>
			<select id="start-time" name="start-time" required class="form-control">
			  <option value="9">9시</option>
			  <option value="10">10시</option>
			  <option value="11">11시</option>
			  <option value="12">12시</option>
			  <option value="13">13시</option>
			  <option value="14">14시</option>
			  <option value="15">15시</option>
			  <option value="16">16시</option>
			  <option value="17">17시</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="end-time" class="sr-only">종료 시간</label>
			<!-- <input type="time" id="end-time" name="end-time" required class="form-control"> -->
			<select id="end-time" name="end-time" required class="form-control">
			  <option value="9">9시</option>
			  <option value="10">10시</option>
			  <option value="11">11시</option>
			  <option value="12">12시</option>
			  <option value="13">13시</option>
			  <option value="14">14시</option>
			  <option value="15">15시</option>
			  <option value="16">16시</option>
			  <option value="17">17시</option>
			  <option value="18">18시</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">과목명</label>
			<input type="text" id="subject" name="subject" required class="form-control">
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">교수명</label>
			<input type="text" id="profname" name="profname" class="form-control">
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">강의실</label>
			<input type="text" id="roomno" name="roomno" class="form-control">
		  </div>
		  <button type="submit" id="btnAdd" class="btn btn-primary mb-2">추가하기</button>
		</form>
		</div>
	</div>
	
	<script>
		const form = document.getElementById("timeline-form");
		const table = document.getElementById("timeline-table");

		form.addEventListener("submit", function(event) {
			event.preventDefault();

			const dayOfWeek = document.getElementById("day").value;
			const startTime = document.getElementById("start-time").value;
			const endTime = document.getElementById("end-time").value;
			const subjectName = document.getElementById("subject").value;
			const profname = document.getElementById("profname").value;
			const roomNo = document.getElementById("roomno").value;
			const timeGap = parseInt(endTime)-parseInt(startTime);
			
			var rowNum;
			var columnNum;
			
			switch (dayOfWeek) {
				case "Mon" :
					columnNum = 1;
					break;
				case "Tue" :
					columnNum = 2;
					break;
				case "Wed" :
					columnNum = 3;
					break;
				case "Thur" :
					columnNum = 4;
					break;
				case "Fri" :
					columnNum = 5;
					break;
			}
			
			switch (startTime) {
				case "9" :
					rowNum = 1;
					break;
				case "10" :
					rowNum = 2;
					break;
				case "11" :
					rowNum = 3;
					break;
				case "12" :
					rowNum = 4;
					break;
				case "13" :
					rowNum = 5;
					break;
				case "14" :
					rowNum = 6;
					break;
				case "15" :
					rowNum = 7;
					break;
				case "16" :
					rowNum = 8;
					break;
				case "17" :
					rowNum = 9;
					break;
			}
						
			table.rows[rowNum].cells[columnNum].innerHTML = '<p style="white-space:pre; margin-bottom:0;">' + subjectName + '\n' + profname + '\n' + roomNo + '</p>';
			table.rows[rowNum].cells[columnNum].style.backgroundColor = getRandomColor();
			
			if (timeGap >= 2) {
				for (var multiTimes = 1; multiTimes < timeGap; multiTimes++) {
					rowNum++;
					table.rows[rowNum].cells[columnNum].innerHTML = '<p style="white-space:pre; margin-bottom:0;">' + subjectName + '\n' + profname + '\n' + roomNo + '</p>';
					table.rows[rowNum].cells[columnNum].style.backgroundColor = table.rows[rowNum-1].cells[columnNum].style.getPropertyValue("background-color");
				}
			}

			form.reset();
		});
		
		function getRandomColor() {
			var red = Math.floor(Math.random() * 100) + 100;	
			var green = Math.floor(Math.random() * 100) + 100;
			var blue = Math.floor(Math.random() * 100) + 100;
			return "rgb(" + red + ", " + green + ", " + blue + ")";
		}
		
		var tableRows = table.rows;
		for (var i = 1; i < tableRows.length; i++) {
			tableRows[i].style.height = "100px";
		}
		
		// 	<------------------------------------------------->	
		//	클릭한 셀 한개만 삭제하는 코드
		// table.onclick = function(event) {
		// 	let target = event.target;
		// 	while (target != this) {
		// 		if (target.tagName == 'TD') {
		// 			target.innerHTML = '';
		// 			target.removeAttribute("style");
		// 			return;
		// 		}
		// 		target = target.parentNode;
		// 	}
		// };
		
		table.ondblclick = function(event) {
		  let target = event.target;
		  while (target != this) {
			if (target.tagName == 'TD') {
			  const currentContent = target.innerHTML;
			  const currentStyle = target.getAttribute('style');
			  const cells = this.querySelectorAll('td');
			  cells.forEach(cell => {
				if (cell.innerHTML === currentContent && cell.getAttribute('style') === currentStyle) {
				  cell.innerHTML = '';
				  cell.removeAttribute('style');
				}
			  });
			  return;
			}
			target = target.parentNode;
		  }
		};


	</script>
</body>
</html>