<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>시간표</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
<link rel="stylesheet" href="./style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
	<style>
		* {
			font-family: 'Jua', sans-serif;
		}
	</style>
</head>
<body>
	
	<div class="Container" id="conatainer" style="float:left; width:100%; height:100%" align="center">
		<div class="table-form-wrapper">
		<table style="color: #121212;" width="800" height="300" class="table caption-top" id="timeline-table">
		<caption>▶   나의 시간표  ◀</caption>
		  <tr>
			<th style="background-color:#FFDBF8;"></th>
			<th style="background-color:#FFDBF8;">월</th>
			<th style="background-color:#FFDBF8;">화</th>
			<th style="background-color:#FFDBF8;">수</th>
			<th style="background-color:#FFDBF8;">목</th>
			<th style="background-color:#FFDBF8;">금</th>
		  </tr>
		  <tr>
			<th>9시<br>1교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>10시<br>2교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>11시<br>3교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>12시<br>4교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>13시<br>5교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>14시<br>6교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>15시<br>7교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>16시<br>8교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		  <tr>
			<th>17시<br>9교시</th>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		  </tr>
		</table>

		<form class="form-inline" id="timeline-form" style="margin-top: 200px; margin-right:150px; margin-left: 0px;">
		  <div class="form-group mx-sm-5 mb-2">
			<label for="day" class="sr-only">요일</label>
			<select id="day" name="day" class="form-control">
			  <option value="Mon">월요일</option>
			  <option value="Tue">화요일</option>
			  <option value="Wed">수요일</option>
			  <option value="Thur">목요일</option>
			  <option value="Fri">금요일</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="start-time" class="sr-only">시작 시간</label>
			<select id="start-time" name="start-time" required class="form-control">
			  <option value="9">9시</option>
			  <option value="10">10시</option>
			  <option value="11">11시</option>
			  <option value="12">12시</option>
			  <option value="13">13시</option>
			  <option value="14">14시</option>
			  <option value="15">15시</option>
			  <option value="16">16시</option>
			  <option value="17">17시</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="end-time" class="sr-only">종료 시간</label>
			<!-- <input type="time" id="end-time" name="end-time" required class="form-control"> -->
			<select id="end-time" name="end-time" required class="form-control">
			  <option value="9">9시</option>
			  <option value="10">10시</option>
			  <option value="11">11시</option>
			  <option value="12">12시</option>
			  <option value="13">13시</option>
			  <option value="14">14시</option>
			  <option value="15">15시</option>
			  <option value="16">16시</option>
			  <option value="17">17시</option>
			  <option value="18">18시</option>
			</select>
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">과목명</label>
			<input type="text" id="subject" name="subject" required class="form-control">
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">교수명</label>
			<input type="text" id="profname" name="profname" class="form-control">
		  </div>
		  <div class="form-group mx-sm-5 mb-2">
			<label for="activity" class="sr-only">강의실</label>
			<input type="text" id="roomno" name="roomno" class="form-control">
		  </div>
		  <button type="submit" id="btnAdd" class="btn btn-primary mb-2">추가하기</button>
		</form>
		</div>
	</div>
	
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script>
		$(document).ready(function() {
		  const form = $("#timeline-form");
		  const table = $("#timeline-table");

		  form.on("submit", function(event) {
			event.preventDefault();

			const dayOfWeek = $("#day").val();
			const startTime = $("#start-time").val();
			const endTime = $("#end-time").val();
			const subjectName = $("#subject").val();
			const profname = $("#profname").val();
			const roomNo = $("#roomno").val();
			const timeGap = parseInt(endTime) - parseInt(startTime);

			let rowNum;
			let columnNum;
			let subCode;

			switch (dayOfWeek) {
			  case "Mon":
				columnNum = 0;
				break;
			  case "Tue":
				columnNum = 1;
				break;
			  case "Wed":
				columnNum = 2;
				break;
			  case "Thur":
				columnNum = 3;
				break;
			  case "Fri":
				columnNum = 4;
				break;
			}

			switch (startTime) {
			  case "9":
				rowNum = 1;
				break;
			  case "10":
				rowNum = 2;
				break;
			  case "11":
				rowNum = 3;
				break;
			  case "12":
				rowNum = 4;
				break;
			  case "13":
				rowNum = 5;
				break;
			  case "14":
				rowNum = 6;
				break;
			  case "15":
				rowNum = 7;
				break;
			  case "16":
				rowNum = 8;
				break;
			  case "17":
				rowNum = 9;
				break;
			}
			
			subCode = "subCode" + rowNum + columnNum;
			table.find("tr:eq(" + rowNum + ")").find("td:eq(" + columnNum + ")").html('<p style="white-space:pre; margin-bottom:0;">' + subjectName + '\n' + profname + '\n' + roomNo + '</p>').css("background-color", getRandomColor()).addClass(subCode);;
			  
			if (timeGap >= 2) {
			  for (let multiTimes = 1; multiTimes < timeGap; multiTimes++) {
				rowNum++;
				table.find("tr:eq(" + rowNum + ")").find("td:eq(" + columnNum + ")").html('<p style="white-space:pre; margin-bottom:0;">' + subjectName + '\n' + profname + '\n' + roomNo + '</p>').css("background-color", table.find("tr:eq(" + (rowNum - 1) + ")").find("td:eq(" + columnNum + ")").css("background-color")).addClass(subCode);
			  }
			}

			form[0].reset();
		  });

		  function getRandomColor() {
			let red = Math.floor(Math.random() * 100) + 100;
			let green = Math.floor(Math.random() * 100) + 100;
			let blue = Math.floor(Math.random() * 100) + 100;
			return "rgb(" + red + ", " + green + ", " + blue + ")";
		  }

		  table.find("tr:not(:first-child)").css("height", "100px");

		  // <------------------------------------------------->
		  // 클릭한 셀 한개만 삭제하는 코드
		  // table.on("click", function(event) {
		  //   let target = event.target;
		  //   while (target != this) {
		  //     if (target.tagName == "TD") {
		  //       $(target).html("").removeAttr("style");
		  //       return;
		  //     }
		  //     target = target.parentNode;
		  //   }
		  // });

		
		//   $("#timeline-table").on("dblclick", "td", function() {
		//     const currentContent = $(this).html();
		//     const currentStyle = $(this).attr("style");
		//     $("#timeline-table td").each(function() {
		//   	  if ($(this).html() === currentContent && $(this).attr("style") === currentStyle) {
		// 	    $(this).html("");
		// 	    $(this).removeAttr("style");
		// 	  }
		//     });
		//   });
			
		// });
			
		// 	<----------모든 칸 검사 코드----------->
		
		// 	$("#timeline-table").on("dblclick", "td", function() {
		// 	  const currentClass = $(this).attr("class");
		// 	  $("#timeline-table td").each(function() {
		// 		if ($(this).attr("class") === currentClass) {
		// 		  $(this).html("");
		// 		  $(this).removeAttr("style");
		// 		  $(this).removeClass(currentClass);
		// 		}
		// 	  });
		// 	});
		// });
		
			$("#timeline-table").on("dblclick", "td", function() {
			  const currentClass = $(this).attr("class");
			  $("#timeline-table td." + currentClass).html("").removeAttr("style").removeClass(currentClass);
			});
		});


	</script>
</body>
</html>